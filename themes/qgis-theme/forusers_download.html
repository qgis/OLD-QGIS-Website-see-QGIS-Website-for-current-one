<section class="intro">
    <div class="container">
        <h2>{{ _('Download QGIS for your platform') }}</h2>
        <p class="main">{{ _('Binary packages (installers) are available from this page.') }}</p>
        <p class="main">{{ _('The current version is QGIS %s \'%s\' and was released on %s.')|format( release, codename, releasedate.strftime('%d.%m.%Y') ) }}</p>
        <p class="main">{{ _('The long-term repositories currently offer QGIS %s \'%s\'.')|format( ltrrelease, ltrcodename ) }}</p>
        <p class="main">{{ _('QGIS is available on Windows, MacOS X, Linux and Android.') }}</p>
{% if infeaturefreeze == True %}
        <p class="main">
          {{ _('We are currently in feature freeze preceeding the release of QGIS %s. <b>Please consider testing the prereleases</b>. See ')|format(nextversion) }}
	  <a href="{{ pathto('site/getinvolved/development/roadmap') }}#location-of-prereleases-nightly-builds">{{ _("road map") }}</a>.
        </p>
{% endif %}
    </div>
</section>
<section class="content">
    <div class="container">
        <ul class="nav nav-tabs" id="tabs">
          <li class="active"><a href="#tab1">{{ _('Installation Downloads') }}</a></li>
          <li><a href="#tab2">{{ _('All Releases') }}</a></li>
          <li><a href="#tab3">{{ _('Sources') }}</a></li>
        </ul>

        <div class="tab-content">

          <!-- Tab 1 -->
          <div class="tab-pane active" id="tab1">
            <!-- Downloads Accordion -->
              <a name="windows"></a>
              <div class="accordion" id="downloads">
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#windows">
                      <h4>{{ _('Download for Windows') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="windows" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <div>
                        <h5>{{ _('QGIS in OSGeo4W:') }}</h5>
                        <a href="http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86_64.exe" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-large icon-download-alt"></i></li>
                          <li class="osgeo-download"></li>
                          <li class="download-text">{{ _('OSGeo4W Network Installer (64 bit)') }}</li>
                        </ul>
                        </a>
                        <a href="http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86.exe" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-large icon-download-alt"></i></li>
                          <li class="osgeo-download"></li>
                          <li class="download-text">{{ _('OSGeo4W Network Installer (32 bit)') }}</li>
                        </ul>
                        </a>
                        <p>{{ _('In the installer choose ') }}<strong>{{ _('Desktop Express Install') }}</strong> {{ _('and select') }} <strong>{{ _('QGIS') }}</strong> {{ _('to install the <em>latest release</em>.') }}<br/>
                        {{ _('To get the <em>long term release</em> (that is not also the latest release) choose ') }}<strong>{{ _('Advanced Install') }}</strong> {{ _('and select ') }} <strong>{{ _('qgis-ltr-full') }}</strong><br/>
                        {{ _('To get the <em>bleeding-edge development build</em> choose ') }}<strong>{{ _('Advanced Install') }}</strong> {{ _('and select ') }} <strong>{{ _('qgis-dev-full') }}</strong>
			<br/>
                      </div>
                      <div>
                        <h5>{{ _('Standalone installers from OSGeo4W packages') }}</h5>
                        <h6>{{ _('Latest release (richest on features):') }}</h6>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86_64.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (64 bit)')|format( version ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86_64.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (32 bit)')|format( version ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <h6>{{ _('Long term release repository (most stable):') }}</h6>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86_64.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis2-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (64 bit)')|format( ltrversion ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86_64.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis2-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (32 bit)')|format( ltrversion ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
                <a name="mac"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#mac">
                      <h4>{{ _('Download for Mac OS X') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="mac" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <h6>{{ _('Latest release (richest on features):') }}</h6>
                      <p>{{ _('Mac Installer Package for macOS El Capitan (10.11) and newer.') }}</p>
                      <p>{{ _('Installation instructions are in the Read Me on the disk image. This package uses the <a href="http://www.python.org/" class="reference external">python.org Python 3.6</a>, version 3.6, the "macosx10.9" build - other distributions are not supported. Install packages in the numbered order.') }}</p>
                      <a href="http://qgis.org/downloads/macOS/QGIS-macOS-{{ release_mac|e }}-{{ binary_mac|e }}.dmg" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-download-alt icon-large"></i></li>
                          <li class="qgis-download"></li>
                          <li class="download-text">{{ _('QGIS macOS Installer Version %s')|format( release_mac ) }}</li>
                        </ul>
                      </a>
                      <h6>{{ _('Long term release (most stable):') }}</h6>
                      <p>{{ _('Mac Installer Package for OS X Mountain Lion (10.8) and newer.') }}</p>
                      <p>{{ _('Installation instructions are in the Read Me on the disk image. This package uses the system Python 2.7 - other distributions are not supported. It also requires the NumPy and Matplotlib packages on the disk image. Install packages in the numbered order. If an older major version is being upgraded (2.16 or older), delete QGIS.app from your Applications folder before installing this version.') }}</p>
                      <a href="http://qgis.org/downloads/macOS/QGIS-OSX-{{ ltrrelease_mac|e }}-{{ ltrbinary_mac|e }}.dmg" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-download-alt icon-large"></i></li>
                          <li class="qgis2-download"></li>
                          <li class="download-text">{{ _('QGIS OS X Installer Version %s')|format( ltrversion ) }}</li>
                        </ul>
                      </a>
                    </div>
                  </div>
                </div>
                <a name="linux"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#linux">
                      <h4>{{ _('Download for Linux') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="linux" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p>{{ _('For many flavors of GNU/Linux binary packages (rpm and deb) or software repositories (to add to your installation manager) are available. Please select your choice of distro below:') }}</p>
                      <ul>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#archlinux">{{ _('ArchLinux') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#debian-ubuntu">{{ _('Debian/Ubuntu') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#fedora">{{ _('Fedora') }}</a></li>
		      <li><a href="{{ pathto('site/forusers/alldownloads') }}#flatpak">{{ _('Flatpak') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#mandriva">{{ _('Mandriva') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#opensuse">{{ _('openSUSE') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#rhel-centos-scientific-linux">{{ _('RHEL, CentOS, Scientific Linux, ...') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#slackware">{{ _('Slackware') }}</a></li>
		      <li><a href="{{ pathto('site/forusers/alldownloads') }}#solus>{{ _('Solus') }}</a></li>
                      </ul>
                      <p class="download-text"><a href="{{ pathto('site/forusers/alldownloads') }}#linux">{{ _('Linux Installation Instructions') }}</a></p>
                    </div>
                  </div>
                </div>
                <a name="bsd"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#bsd">
                      <h4>{{ _('Download for BSD') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="bsd" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p class="download-text"><a href="{{ pathto('site/forusers/alldownloads') }}#freebsd">{{ _('BSD Installation Instructions') }} </a></p>
                    </div>
                  </div>
                </div>
                <a name="android"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#android">
                      <h4>{{ _('Download for Android') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="android" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p>{{ _('An experimental release can be found in the ') }}<a href="https://play.google.com/store/apps/details?id=org.qgis.qgis" class="reference external" ><strong>Play Store</strong></a></p>
                    </div>
                  </div>
                </div>
              </div>
              <!-- End Accordion -->

              <h4><a href="{{ pathto('site/forusers/alldownloads') }}">{{ _('All downloads') }}</a></h4>
              <p>
                {{ _('More specific instructions about downloading QGIS stable vs QGIS development can be found in') }} <a href="{{ pathto('site/forusers/alldownloads') }}">{{ _('All downloads') }}</a>.
              </p>

              <h4><a href="http://docs.qgis.org/{{version}}/{{language}}/docs/user_manual/introduction/getting_started.html">{{ _('Datasets') }}</a></h4>
              <p>{{ _('For testing and learning purposes, a ') }} <a href="http://docs.qgis.org/{{version}}/{{language}}/docs/user_manual/introduction/getting_started.html#sample-data"><strong>{{ _('sample dataset is available') }}</strong></a>, {{ _('which contains collections of data from different sources and in different formats.') }}</p>

          </div>

          <!-- Tab 2 -->
          <div class="tab-pane" id="tab2">
              <p>{{ _('Older releases of QGIS are available') }} <a href="http://download.osgeo.org/qgis/" class="reference external">{{ _('here') }}</a>. {{ _('More older releases for OS X are available') }} <a href="http://www.kyngchaos.com/software/archive/" class="reference external">{{ _('here') }}</a>.</p>
              <p>{{ _('Plugins for QGIS are also available ') }}<a href="http://plugins.qgis.org/plugins/" class="reference external">{{ _('here') }}</a>.</p>
          </div>

          <!-- Tab 3 -->
          <div class="tab-pane" id="tab3">
              <p>{{ _('QGIS is open source software available under the terms of the') }} <b>{{ _('GNU General Public License') }}</b> {{ _('meaning that its source code can be downloaded through tarballs or the git repository.') }}</p>
              <p>{{ _('QGIS Source Code is available ') }}
                 <a href="http://qgis.org/downloads/qgis-latest.tar.bz2">{{ _('here (latest release)') }}</a> and
                 <a href="http://qgis.org/downloads/qgis-latest-ltr.tar.bz2">{{ _('here (long term release)') }}</a></p>
              <p>{{ _('Refer to the INSTALL guide on how to compile QGIS from source for the different platforms:') }} <a href="http://htmlpreview.github.io/?https://raw.github.com/qgis/QGIS/master/doc/INSTALL.html"  class="reference external">{{ _('here') }}</a></p>
              <p>{{ _('Note that you can also install the development version (nightly) via an installer from the normal downloads for your platform:') }} <a class="caption-link" href="{{ pathto('site/forusers/download') }}" target="_blank">{{ _('here')}}</a></p>
              <p>{{ _('Plugins for QGIS are also available ') }}<a href="http://plugins.qgis.org/plugins/" class="reference external">{{ _('here') }}</a>.</p>
          </div>
        </div>

        <script>

          $(function () {
            $('#tabs a').click(function (e) {
              e.preventDefault();
              $(this).tab('show');
            });

            // Detect browser and open accordion tab for that os
            var os = "unknown";
			if (navigator.platform.toUpperCase().indexOf("WIN")!=-1) os="windows";
			if (navigator.platform.toUpperCase().indexOf("MAC")!=-1) os="mac";
			if (navigator.platform.toUpperCase().indexOf("X11")!=-1) os="unix";
			if (navigator.platform.toUpperCase().indexOf("LINUX")!=-1) os="linux";
			if (navigator.platform.toUpperCase().indexOf("BSD")!=-1) os="bsd";
			if (navigator.platform.toUpperCase().indexOf("ANDROID")!=-1) os="android";

            // Add handler for accordion toggles
            $('.accordion-toggle').click(function(){
                var el = $(this).find("i");
                if (el.hasClass("icon-chevron-down")) {
                  el.removeClass("icon-chevron-down")
                    .addClass("icon-chevron-left");
                } else {
                  el.removeClass("icon-chevron-left")
                    .addClass("icon-chevron-down");
                }
            });

            // Close unrelated if 1. hash tag is detected or 2. os is detected
            var url = window.location.hash;
            var hash = url.substring(url.lastIndexOf('#'), url.length);
            var look_for = (hash == "" || hash == -1) ? os : hash.substring(1, hash.length);

            $('.accordion-body').each(function(){
              if ($(this).attr('id').toLowerCase() !== look_for) {
                $(this).prev().children(":first-child").click();
              }
            });


          })
        </script>
    </div>
</section>
