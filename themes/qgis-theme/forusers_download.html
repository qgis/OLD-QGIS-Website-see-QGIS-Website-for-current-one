<section class="intro">
    <div class="container">
        <h2>{{ _('Download QGIS for your platform') }}</h2>
        <p class="main">{{ _('QGIS is available on Windows, MacOS X, Linux and Android.') }}</p>
        <!-- Update the line below when the latest release is no longer the LTR:  replace version by ltrversion -->
	<p class="main">{{ _('The current long-term release (for corporate users) is QGIS %s \'%s\'.')|format( version, codename ) }}</p>
        <p class="main">{{ _('The current version is QGIS %s \'%s\' and was released on %s.')|format( release, codename, releasedate.strftime('%d.%m.%Y') ) }}</p>
        <p class="main">{{ _('Binary packages (installers) for current stable version {0} can be downloaded here.').format( version ) }}</p>
<!-- Comment out after release
        <p class="main">
          {{ _('We are currently in feature freeze preceding the release of QGIS 2.9. <b>Please consider testing the prereleases</b>. See ') }}
	  <a href="{{ pathto('site/getinvolved/development/index') }}#road-map">{{ _("road map") }}</a>.
        </p>
-->
    </div>
</section>
<section class="content">
    <div class="container">
        <ul class="nav nav-tabs" id="tabs">
          <li class="active"><a href="#tab1">{{ _('Installation Downloads') }}</a></li>
          <li><a href="#tab2">{{ _('All Releases') }}</a></li>
          <li><a href="#tab3">{{ _('Sources') }}</a></li>
        </ul>

        <div class="tab-content">

          <!-- Tab 1 -->
          <div class="tab-pane active" id="tab1">
            <!-- Downloads Accordion -->
              <a name="windows"></a>
              <div class="accordion" id="downloads">
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#windows">
                      <h4>{{ _('Download for Windows') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="windows" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <div>
                        <h5>{{ _('Standalone Installers:') }}</h5>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (32 bit)')|format( version ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86_64.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (64 bit)')|format( version ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ release|e }}-{{ binary|e }}-Setup-x86_64.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (32 bit)')|format( ltrversion ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86_64.exe" class="reference external">
                          <ul class="inline download-row">
                              <li><i class="icon-download-alt icon-large"></i></li>
                              <li class="qgis-download"></li>
                              <li class="download-text">{{ _('QGIS Standalone Installer Version %s (64 bit)')|format( ltrversion ) }}</li>
                          </ul>
                        </a>
                        <a href="http://qgis.org/downloads/QGIS-OSGeo4W-{{ ltrrelease|e }}-{{ ltrbinary|e }}-Setup-x86_64.exe.md5sum" class="reference external button">
                          <ul class="inline download-row">
                              <li></li>
                              <li></li>
                              <li class="download-text">md5</li>
                          </ul>
                        </a>
                      </div>
                      <div>
                        <h5>{{ _('Custom Installers:') }}</h5>
                        <a href="http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86.exe" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-large icon-download-alt"></i></li>
                          <li class="osgeo-download"></li>
                          <li class="download-text">{{ _('OSGeo4W Network Installer (32 bit)') }}</li>
                        </ul>
                        </a>
                        <a href="http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86_64.exe" class="reference external">
                        <ul class="inline download-row">
                          <li><i class="icon-large icon-download-alt"></i></li>
                          <li class="osgeo-download"></li>
                          <li class="download-text">{{ _('OSGeo4W Network Installer (64 bit)') }}</li>
                        </ul>
                        </a>
                        <p>{{ _('In the installer choose ') }}<strong>{{ _('Desktop Express Install') }}</strong> {{ _('and select') }} <strong>{{ _('QGIS') }}</strong> {{ _('to install the latest release.') }}</p>
                        <p>{{ _('To get different or multiple releases choose ') }}<strong>{{ _('Advanced Install') }} {{ _('and :') }}</strong>
			  <ul>
                            <li>{{ _('For the latest release select ') }}<strong>{{ _('qgis') }}</strong></li>
                            <li>{{ _('For the long term release select ') }}<strong>{{ _('qgis-ltr') }}</strong> {{ _('. Note that when the long-term release is also the latest you need to check ') }} <strong>{{ _('qgis') }}</strong></li>
                            <li>{{ _('For the development branch select ') }}<strong>{{ _('qgis-dev') }}</strong></li>
                          </ul>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <a name="mac"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#mac">
                      <h4>{{ _('Download for Mac OS X') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="mac" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p>{{ _('Mac Installer Package for both OS X Mavericks (10.9), Mountain Lion (10.8) and Lion (10.7).') }}</p>
                      <p>{{ _('This version requires') }} <strong> {{ _('separate installation of dependency framework (GDAL Complete)') }} </strong>{{ _(', also found at the download link below.') }}</p>

                      <p class="download-text">
                        <i class="icon-download-alt icon-large"></i> &nbsp; &nbsp;
                        <a href="http://www.kyngchaos.com/software/qgis" class="reference external">{{ _('KyngChaos QGIS download page') }}</a>
                      </p>
                    </div>
                  </div>
                </div>
                <a name="linux"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#linux">
                      <h4>{{ _('Download for Linux') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="linux" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p>{{ _('For many flavors of GNU/Linux binary packages (rpm and deb) or software repositories (to add to your installation manager) are available. Please select your choice of distro below:') }}</p>
                      <ul>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#debian-ubuntu">{{ _('Debian/Ubuntu') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#fedora">{{ _('Fedora') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#opensuse">{{ _('openSUSE') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#rhel-centos-scientific-linux">{{ _('RHEL, CentOS, Scientific Linux, ...') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#mandriva">{{ _('Mandriva') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#slackware">{{ _('Slackware') }}</a></li>
                      <li><a href="{{ pathto('site/forusers/alldownloads') }}#archlinux">{{ _('ArchLinux') }}</a></li>
                      </ul>
                      <p class="download-text"><a href="{{ pathto('site/forusers/alldownloads') }}#linux">{{ _('Linux Installation Instructions') }}</a></p>
                    </div>
                  </div>
                </div>
                <a name="bsd"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#bsd">
                      <h4>{{ _('Download for BSD') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="bsd" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p class="download-text"><a href="{{ pathto('site/forusers/alldownloads') }}#freebsd">{{ _('BSD Installation Instructions') }} </a></p>
                    </div>
                  </div>
                </div>
                <a name="android"></a>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#downloads" href="#android">
                      <h4>{{ _('Download for Android') }} <i class="icon-chevron-down pull-right"></i></h4>
                    </a>
                  </div>
                  <div id="android" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      <p>{{ _('An experimental release can be found in the ') }}<a href="https://play.google.com/store/apps/details?id=org.qgis.qgis" classe="reference external" ><strong>Play Store</strong></a></p>
                    </div>
                  </div>
                </div>
              </div>
              <!-- End Accordion -->

              <h4><a href="{{ pathto('site/forusers/alldownloads') }}">{{ _('All downloads') }}</a></h4>
              <p>
                {{ _('More specific instructions about downloading QGIS stable vs QGIS development can be found in') }} <a href="{{ pathto('site/forusers/alldownloads') }}">{{ _('All downloads') }}</a>.
              </p>

              <h4><a href="http://docs.qgis.org/{{version}}/{{language}}/docs/user_manual/introduction/getting_started.html">{{ _('Datasets') }}</a></h4>
              <p>{{ _('For testing and learning purposes, a ') }} <a href="http://docs.qgis.org/{{version}}/{{language}}/docs/user_manual/introduction/getting_started.html#sample-data"><strong>{{ _('sample dataset is available') }}</strong></a>, {{ _('which contains collections of data from different sources and in different formats.') }}</p>

          </div>

          <!-- Tab 2 -->
          <div class="tab-pane" id="tab2">
              <p>{{ _('Older releases of QGIS are available') }} <a href="http://download.osgeo.org/qgis/windows/" class="reference external">{{ _('here') }}</a>.</p>
              <p>{{ _('Plugins for QGIS are also available ') }}<a href="http://plugins.qgis.org/plugins/" class="reference external">{{ _('here') }}</a>.</p>
          </div>

          <!-- Tab 3 -->
          <div class="tab-pane" id="tab3">
              <p>{{ _('QGIS is open source software available under the terms of the') }} <b>{{ _('GNU General Public License') }}</b> {{ _('meaning that its source code can be downloaded through tarballs or the git repository.') }}</p>
              <p>{{ _('QGIS Source Code is available ') }}
                 <a href="http://qgis.org/downloads/qgis-latest.tar.bz2">{{ _('here (latest release)') }}</a> and
                 <a href="http://qgis.org/downloads/qgis-latest-ltr.tar.bz2">{{ _('here (long term release)') }}</a></p>
              <p>{{ _('Refer to the INSTALL guide on how to compile QGIS from source for the different platforms:') }} <a href="http://htmlpreview.github.io/?https://raw.github.com/qgis/QGIS/master/doc/INSTALL.html"  class="reference external">{{ _('here') }}</a></p>
              <p>{{ _('Note that you can also install the development version (nightly) via an installer from the normal downloads for your platform:') }} <a class="caption-link" href="{{ pathto('site/forusers/download') }}" target="_blank">{{ _('here')}}</a></p>
              <p>{{ _('Plugins for QGIS are also available ') }}<a href="http://plugins.qgis.org/plugins/" class="reference external">{{ _('here') }}</a>.</p>
          </div>
        </div>

        <script>

          $(function () {
            $('#tabs a').click(function (e) {
              e.preventDefault();
              $(this).tab('show');
            });

            // Detect browser and open accordion tab for that os
            var os = "unknown";
			if (navigator.platform.toUpperCase().indexOf("WIN")!=-1) os="windows";
			if (navigator.platform.toUpperCase().indexOf("MAC")!=-1) os="mac";
			if (navigator.platform.toUpperCase().indexOf("X11")!=-1) os="unix";
			if (navigator.platform.toUpperCase().indexOf("LINUX")!=-1) os="linux";
			if (navigator.platform.toUpperCase().indexOf("BSD")!=-1) os="bsd";
			if (navigator.platform.toUpperCase().indexOf("ANDROID")!=-1) os="android";

            // Add handler for accordion toggles
            $('.accordion-toggle').click(function(){
                var el = $(this).find("i");
                if (el.hasClass("icon-chevron-down")) {
                  el.removeClass("icon-chevron-down")
                    .addClass("icon-chevron-left");
                } else {
                  el.removeClass("icon-chevron-left")
                    .addClass("icon-chevron-down");
                }
            });

            // Close unrelated if 1. hash tag is detected or 2. os is detected
            var url = window.location.hash;
            var hash = url.substring(url.lastIndexOf('#'), url.length);
            var look_for = (hash == "" || hash == -1) ? os : hash.substring(1, hash.length);

            $('.accordion-body').each(function(){
              if ($(this).attr('id').toLowerCase() !== look_for) {
                $(this).prev().children(":first-child").click();
              }
            });


          })
        </script>
    </div>
</section>
